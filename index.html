<!DOCTYPE html>
<!-- ==========================================================
  Project: MOYAMOVA
  File: index.html
  Purpose: –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  Version: 1.0
  Last modified: 2025-10-19
-->
<html lang="uk">
<head>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DZL66KME4H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-DZL66KME4H', { 'send_page_view': false });
    window.trackPageView = function(path) {
      try {
        gtag('event', 'page_view', { page_path: path || (location.pathname + location.hash), page_title: document.title });
      } catch(e) { }
    };
  </script>

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
  <meta http-equiv="Pragma" content="no-cache"/>
  <meta http-equiv="Expires" content="0"/>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"/>
  <title>MOYAMOVA</title>

  <!-- ============================ SOCIAL PREVIEW ============================ -->
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="MOYAMOVA ¬∑ —É—á–∏—Ç–µ —Å–ª–æ–≤–∞ –ª–µ–≥–∫–æ"/>
  <meta property="og:description" content="–ö–∞—Ä—Ç–æ—á–∫–∏, –±—ã—Å—Ç—Ä—ã–µ —Å–µ—Å—Å–∏–∏, –ò–∑–±—Ä–∞–Ω–Ω–æ–µ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞. –£—á–∏—Ç–µ –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –±–µ–∑ —Ä–µ–∫–ª–∞–º—ã –∏ –ø–æ–¥–ø–∏—Å–∫–∏."/>
  <meta property="og:image" content="https://moyamova.online/og-cover.png"/>
  <meta property="og:url" content="https://moyamova.online/"/>
  <meta property="og:image:type" content="image/png"/>
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="MOYAMOVA ¬∑ —É—á–∏—Ç–µ —Å–ª–æ–≤–∞ –ª–µ–≥–∫–æ"/>
  <meta name="twitter:description" content="–ö–∞—Ä—Ç–æ—á–∫–∏, –±—ã—Å—Ç—Ä—ã–µ —Å–µ—Å—Å–∏–∏, –ò–∑–±—Ä–∞–Ω–Ω–æ–µ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞. –£—á–∏—Ç–µ –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –±–µ–∑ —Ä–µ–∫–ª–∞–º—ã –∏ –ø–æ–¥–ø–∏—Å–∫–∏."/>
  <meta name="twitter:image" content="https://moyamova.online/og-cover.png"/>

  <!-- ============================ ICONS & MANIFEST ============================ -->
  <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon-180x180.png?v=1.0"/>
  <link rel="apple-touch-icon" sizes="152x152" href="./apple-touch-icon-152x152.png?v=1.0"/>
  <link rel="apple-touch-icon" sizes="120x120" href="./apple-touch-icon-120x120.png?v=1.0"/>
  <link rel="apple-touch-icon" sizes="76x76" href="./apple-touch-icon-76x76.png?v=1.0"/>
  <link rel="icon" type="image/png" sizes="192x192" href="./favicon-192x192.png?v=1.0"/>
  <link rel="icon" type="image/png" sizes="512x512" href="./favicon-512x512.png?v=1.0"/>
  <link rel="icon" type="image/png" sizes="256x256" href="./favicon-256x256.png?v=1.0"/>
  <link rel="icon" type="image/png" sizes="128x128" href="./favicon-128x128.png?v=1.0"/>
  <link rel="icon" type="image/png" sizes="48x48" href="./favicon-48x48.png?v=1.0"/>
  <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png?v=1.0"/>
  <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png?v=1.0"/>
  <link rel="icon" type="image/x-icon" href="./favicon.ico?v=1.0"/>
  <link rel="manifest" href="./site.webmanifest?v=1.0"/>

  <meta name="mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <meta name="apple-mobile-web-app-title" content="MOYAMOVA"/>
  <meta name="theme-color" content="#ffffff"/>

  <!-- ============================ STYLES ============================ -->
  <link rel="stylesheet" href="./tokens.css?v=1.0"/>
  <link rel="stylesheet" href="./base.css?v=1.0"/>
  <link rel="stylesheet" href="./components.css?v=1.0"/>
  <link rel="stylesheet" href="./modals.css?v=1.0"/>
  <link rel="stylesheet" href="./states.css?v=1.0"/>
  <link rel="stylesheet" href="./overrides.css?v=1.0"/>
  <link rel="stylesheet" href="./donate.css?v=1.0"/>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&display=swap"/>

  <link rel="canonical" href="https://moyamova.online/"/>
  <meta name="description" content="MOYAMOVA ‚Äî —Ç—Ä–µ–Ω–∞–∂—ë—Ä —Å–ª–æ–≤ –∏ –¥–∏–∞–ª–æ–≥–∞. –û—Ñ—Ñ–ª–∞–π–Ω, –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, RU/UK/EN/DE."/>

  <link rel="alternate" href="https://moyamova.online/" hreflang="x-default"/>
  <link rel="alternate" href="https://moyamova.online/" hreflang="ru"/>
  <link rel="alternate" href="https://moyamova.online/uk/" hreflang="uk"/>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "MOYAMOVA",
    "url": "https://moyamova.online/",
    "applicationCategory": "EducationalApplication",
    "operatingSystem": "Web",
    "inLanguage": ["ru","uk"],
    "description": "MOYAMOVA ‚Äî —Ç—Ä–µ–Ω–∞–∂—ë—Ä –¥–ª—è –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å–ª–æ–≤ –∏ —Ñ—Ä–∞–∑. –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è RU/UK, –æ—Ñ–ª–∞–π–Ω (PWA), –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Monobank –∏ PayPal.",
    "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
    "brand": { "@type": "Brand", "name": "MOYAMOVA" },
    "publisher": { "@type": "Organization", "name": "MOYAMOVA", "email": "peiko.oleh@gmail.com" }
  }
  </script>

  <!-- Critical inline fixes (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –≤ —Ç–≤–æ–µ–π –≤–µ—Ä—Å–∏–∏) -->
  <style id="modal-inline-fix-1.6.3-1758932002">
  /* Critical inline for iOS cache issues ‚Äî v1.6.5-1758932002 */
  .modal .modalHeader{display:flex!important;align-items:center!important;justify-content:space-between!important;padding:14px 14px!important;border-bottom:none!important;font-size:20px!important;font-weight:700!important;line-height:1.2!important}
  .modal .iconBtn.small{width:32px!important;height:32px!important;display:inline-flex!important;align-items:center!important;justify-content:center!important;font-size:18px!important;border-radius:8px!important;background:transparent!important;border:1px solid rgba(255,255,255,.08)!important;opacity:.9!important}
  #modal .modalBody{padding-bottom:0px!important}
  #modal .dictList{padding-bottom:14px!important}
  #modal .dictList > *:last-child{margin-bottom:8px!important}
  .cta{padding:.5rem 1rem;border-radius:.5rem;border:1px solid currentColor;text-decoration:none;display:inline-block}
  .cta:hover{transform:translateY(-1px)}
  </style>
  <style id="dicts-modal-fix">#modal .modalHeader{border-bottom:none!important}</style>

  <!-- –§–∏—Ä–º–µ–Ω–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã/–ª–æ–≥–æ—Ç–∏–ø —Ä–∞–∑–º–µ—Ä -->
  <style>
  .header .logo img, header .logo img, .navbar .logo img, .site-header .logo img { height: 36px !important; width: auto !important; }
  .navbar-brand, .site-title, .brand, header .title, .app-name {
    font-family: 'Montserrat', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif !important;
    font-weight: 700 !important;
    letter-spacing: 0.2px;
  }
  header .tagline, .site-header .tagline, .subtitle, .slogan { display: none !important; }
  </style>

  <!-- –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –∫–∞–∫ –±—ã–ª–æ, defer -->
  <script src="orientation.js" defer></script>
</head>

<body>
<header>
  <div class="brand">
    <img alt="MOYAMOVA" class="logo-mark" decoding="async" height="28" loading="eager" src="./favicon-32x32.png?v=1.0" srcset="./logo_64.png?v=1.0 2x, ./favicon-128x128.png?v=1.0 4x, ./logo_256.png?v=1.0 8x" width="28"/>
    <div class="title-wrap">
      <h1 id="title">MOYAMOVA</h1>
    </div>
  </div>
  <div class="sectionDivider settingsDividerBelowToggle"></div>
  <div class="controls">
    <button aria-label="–¢–µ–º–∞" class="iconBtn" data-title-key="tt_ui_theme" id="themeToggleBtn">üåû</button>
    <button aria-label="–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞" class="iconBtn" data-title-key="tt_ui_lang" id="langToggleBtn">üá∫üá¶</button>
    <button aria-label="–°–ª–æ–≤–∞—Ä–∏" class="iconBtn gear" data-title-key="tt_dicts" id="dictsBtn">üìö</button>
  </div>
</header>

<details class="dictSpoiler" id="dictSpoiler">
  <summary><span class="flag" id="dictFlag">üìö</span><span class="name" id="dictTitleInSpoiler">‚Äî</span></summary>
  <div id="setControls">
    <div aria-label="Sets" class="setsBar" id="setsBar"></div>
    <div aria-live="polite" class="setStats statsBar" id="setStats"></div>
  </div>
</details>

<main>
  <section class="card">
    <div class="topRow">
      <div class="stars" id="stars"></div>
      <button aria-label="–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ" class="heart" data-title-key="tt_favorites" id="favBtn">‚ô°</button>
    </div>
    <div class="word" id="wordText">‚Äî</div>
    <div class="hint" id="hintText">‚Äî</div>
    <div class="options" id="optionsRow"></div>
    <div class="statsBar" id="statsBar">–í—Å–µ–≥–æ —Å–ª–æ–≤: 0 / –ò–∑—É—á–µ–Ω–Ω–æ: 0 / –û—à–∏–±–æ–∫: 0</div>
  </section>

  <div aria-label="Extra actions" class="extraActions">
    <button aria-label="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è" class="iconBtn" data-title-key="tt_help" id="btnInfo">‚ÑπÔ∏è</button>
    <button aria-label="–ü–æ–¥–¥–µ—Ä–∂–∫–∞" class="iconBtn" data-title-key="tt_support" id="btnDonate">üí∞</button>
    <button aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏" class="iconBtn" data-title-key="tt_settings" id="btnSettings">‚öôÔ∏è</button>
  </div>

  <!-- Settings modal -->
  <div class="modal hidden" id="settingsModal" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
    <div class="modalFrame">
      <div class="modalHeader">
        <div class="modalTitle" id="settingsTitle" data-i18n="settingsTitle">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
        <button class="iconBtn small" id="settingsClose" aria-label="Close">‚úñÔ∏è</button>
      </div>
      <div class="modalBody">
        <div class="infoContent" id="settingsContent">
          <!-- Mode toggle -->
          <h3 class="backupTitle" data-i18n="modeSelection" style="text-align:left">–í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞</h3>
          <div id="modeToggleWrap">
            <label class="switchLabel">
              <span data-i18n="modeNormal">–û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º</span>
              <label class="switch">
                <input id="modeToggle" type="checkbox"/>
                <span class="slider"></span>
              </label>
              <span data-i18n="modeHard">–°–ª–æ–∂–Ω—ã–π —Ä–µ–∂–∏–º</span>
            </label>
          </div>

          <div class="sectionDivider"></div>

          <div id="backupSection">
            <h3 class="settingsSubtitle" data-i18n="backupTitle" style="text-align:left">–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
            <div class="btnRow">
              <button class="btn" id="btnBackupExport" data-i18n="backupExport">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
              <button class="btn" id="btnBackupImport" data-i18n="backupImport">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
          </div>

          <script>
            document.addEventListener('DOMContentLoaded', function(){
              try {
                var e = document.getElementById('btnBackupExport');
                var i = document.getElementById('btnBackupImport');
                if (e && window.App && App.Backup) e.addEventListener('click', function(){ App.Backup.export(); });
                if (i && window.App && App.Backup) i.addEventListener('click', function(){ App.Backup.import(); });
              } catch(_) {}
            });
          </script>
        </div>
      </div>
      <div class="modalActions center">
        <button class="btn primary" id="settingsOk" data-i18n="ok">OK</button>
      </div>
    </div>
  </div>

  <!-- Donate modal -->
  <div class="modal hidden" id="donateModal" role="dialog" aria-modal="true" aria-labelledby="donateTitle">
    <div class="modalFrame">
      <div class="modalHeader">
        <div class="modalTitle" id="donateTitle" data-i18n="donateTitle">–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</div>
        <button class="iconBtn small" id="donateClose" aria-label="Close">‚úñÔ∏è</button>
      </div>
      <div class="modalBody">
        <div class="infoContent center" id="donateContent">

          <!-- Monobank -->
          <div class="donateBlock">
            <div class="donateTitle" data-i18n="donateMonoTitle">–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ —á–µ—Ä–µ–∑ Monobank</div>
            <a class="donatePrimary" id="monoDonateLink" href="#" target="_blank" rel="noopener" data-i18n="donateMonoOpen">–í—ñ–¥–∫—Ä–∏—Ç–∏ Monobank</a>
          </div>

          <!-- PayPal -->
          <div class="donateBlock">
            <div class="donateTitle" data-i18n="donatePaypalTitle">–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ —á–µ—Ä–µ–∑ PayPal</div>
            <div class="mt-20" id="donate-button-container">
              <a class="donatePrimary" id="paypalDonateLink" href="#" target="_blank" rel="noopener" data-i18n="donatePaypalOpen">–í—ñ–¥–∫—Ä–∏—Ç–∏ PayPal</a>
              <script>
                (function(){
                  const PAYPAL_BUTTON_ID = 'KFBR8BW5ZZTQ4'; // TODO: –∑–∞–º–µ–Ω–∏—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
                  function paypalUrl(amount){
                    const base = `https://www.paypal.com/donate/?hosted_button_id=${PAYPAL_BUTTON_ID}`;
                    if (!amount || Number(amount) <= 0) return base;
                    return base + `&amount=${encodeURIComponent(String(amount))}`;
                  }
                  const link = document.getElementById('paypalDonateLink');
                  if (link) link.addEventListener('click', function(e){
                    e.preventDefault();
                    const w = window.open(paypalUrl(0), '_blank', 'noopener');
                    if (w && w.opener) w.opener = null;
                  });
                })();
              </script>
            </div>
          </div>

          <!-- Legal donate notice -->
          <div class="donateLegalNote" role="note" style="margin:14px auto 0;max-width:600px;font-size:0.85rem;line-height:1.5;opacity:0.9;display:flex;gap:10px;align-items:flex-start;justify-content:center;text-align:left;">
            <span class="icon" aria-hidden="true" style="font-size:18px;margin-top:2px;">‚öñÔ∏è</span>
            <span data-i18n="donateLegalNote">–î–æ–Ω–∞—Ç —î –¥–æ–±—Ä–æ–≤—ñ–ª—å–Ω–∏–º –ø–æ–∂–µ—Ä—Ç–≤—É–≤–∞–Ω–Ω—è–º —ñ –Ω–µ —î –æ–ø–ª–∞—Ç–æ—é —Ç–æ–≤–∞—Ä—ñ–≤ —á–∏ –ø–æ—Å–ª—É–≥.</span>
          </div>

          <script>
            (function(){
              // Monobank donate
              const MONO_JAR_ID = '56HNLifwyr';
              const base = `https://send.monobank.ua/jar/${MONO_JAR_ID}`;
              function monoUrl(a){ return (!a||Number(a)<=0) ? base : `${base}?amount=${Math.round(Number(a))}`; }
              function openMono(a){ const w = window.open(monoUrl(a),'_blank','noopener'); if(w&&w.opener) w.opener=null; }
              document.addEventListener('click', function(e){
                const btn = e.target.closest('[data-mono-amount]'); if(!btn) return; e.preventDefault();
                const val = Number(btn.getAttribute('data-mono-amount'));
                if(val>0) openMono(val);
                else {
                  const t=(window.T?T('donateMonoPrompt','–í–≤–µ–¥—ñ—Ç—å —Å—É–º—É —É ‚Ç¥'):'–í–≤–µ–¥—ñ—Ç—å —Å—É–º—É —É ‚Ç¥');
                  const userVal=prompt(t,'100'); if(userVal&&!isNaN(Number(userVal))&&Number(userVal)>0) openMono(userVal);
                }
              });
              const link=document.getElementById('monoDonateLink');
              if (link) link.addEventListener('click', function(e){ e.preventDefault(); openMono(0); });
            })();
          </script>

        </div>
      </div>
      <div class="modalActions center">
        <button class="btn primary" id="donateOk" data-i18n="ok">OK</button>
      </div>
    </div>
  </div>

  <!-- Info modal -->
  <div class="modal hidden" id="infoModal" role="dialog" aria-modal="true" aria-labelledby="infoTitle">
    <div class="modalFrame">
      <div class="modalHeader">
        <div class="modalTitle" id="infoTitle">Info</div>
        <button class="iconBtn small" id="infoClose" aria-label="Close">‚úñÔ∏è</button>
      </div>
      <div class="modalBody">
        <div class="infoContent" id="infoContent"></div>
      </div>
      <div class="modalActions center">
        <button class="primary" id="infoOk">OK</button>
      </div>
    </div>
  </div>

  <!-- Dicts modal -->
  <div class="modal hidden" id="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="backdrop" id="backdrop"></div>
    <div class="dialog">
      <div class="modalHeader">
        <h2 class="modalTitle" id="modalTitle">–°–ª–æ–≤–∞—Ä–∏</h2>
        <button class="iconBtn small" id="modalClose" aria-label="Close">‚úñÔ∏è</button>
      </div>
      <div class="modalBody">
        <div class="flagsRow flex-center gap-10 m-10" id="langFlags"></div>
        <div class="sectionDivider"></div>
        <div class="field">
          <div class="dictList" id="dictList"></div>
        </div>
      </div>
      <div class="modalActions center">
        <button class="primary" id="okBtn">OK</button>
      </div>
    </div>
  </div>

</main>

<script src="i18n.js?v=1.0"></script>
<script src="dicts.js?v=1.0"></script>
<script src="deck.de.js?v=1.0"></script>
<script src="deck.en.js?v=1.0"></script>
<script src="app.core.js?v=1.0"></script>
<script src="app.decks.js?v=1.0"></script>
<script src="theme.js?v=1.0"></script>
<script src="app.trainer.js?v=1.0"></script>
<script src="app.mistakes.js?v=1.0"></script>
<script src="app.favorites.js?v=1.0"></script>
<script src="app.ui.view.js?v=1.0"></script>
<script src="ui.options.safe.js?v=1.0"></script>
<script src="ui.setup.modal.js?v=1.0"></script>
<script src="ui.bus.js?v=1.0"></script>
<script src="ui.state.js?v=1.0"></script>
<script src="ui.sets.js?v=1.0"></script>
<script src="ui.progress.scope.js?v=1.0"></script>
<script src="ui.stats.core.js?v=1.0"></script>
<script src="app.backup.js?v=1.0"></script>
<script src="ui.lifecycle.js?v=1.0"></script>
<script src="ui.sets.done.js?v=1.0"></script>
<script src="ui.fix.js?v=1.0"></script>

<!-- I18N runtime hydration -->
<script>
(function(){
  function hydrateI18N(){
    try{
      var App = window.App || {};
      var bag = (App.i18n && App.i18n()) || (window.I18N && (window.I18N[(App.settings&&App.settings.lang)||'uk'] || window.I18N.uk)) || {};
      document.querySelectorAll('[data-i18n]').forEach(function(el){
        var key = el.getAttribute('data-i18n');
        if (bag && bag[key]) el.textContent = bag[key];
      });
      document.querySelectorAll('[data-i18n-title]').forEach(function(el){
        var key = el.getAttribute('data-i18n-title');
        if (bag && bag[key]) el.setAttribute('title', bag[key]);
      });
      document.querySelectorAll('[data-i18n-aria]').forEach(function(el){
        var key = el.getAttribute('data-i18n-aria');
        if (bag && bag[key]) el.setAttribute('aria-label', bag[key]);
      });
    }catch(e){/*noop*/}
  }
  window.hydrateI18N = hydrateI18N;
  document.addEventListener('DOMContentLoaded', hydrateI18N);
  document.addEventListener('i18n:lang-changed', hydrateI18N);
})();
</script>

<!-- Footer injection & legal links localization -->
<script>
(function(){
  function normalizeLang(v){
    v = String(v||'').toLowerCase();
    if (v.startsWith('ru')) return 'ru';
    if (v.startsWith('uk') || v.startsWith('ua')) return 'uk';
    return 'en';
  }
  function uiLang(){
    try{
      var lang = (window.App && App.settings && App.settings.lang) || localStorage.getItem('lexitron.uiLang') || navigator.language || 'en';
      return normalizeLang(lang);
    }catch(e){ return 'en'; }
  }
  var LABELS = {
    en:{privacy:'Privacy Policy',terms:'Terms of Use',impressum:'Legal Notice'},
    ru:{privacy:'–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏',terms:'–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è',impressum:'–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'},
    uk:{privacy:'–ü–æ–ª—ñ—Ç–∏–∫–∞ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–æ—Å—Ç—ñ',terms:'–£–º–æ–≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è',impressum:'–Æ—Ä–∏–¥–∏—á–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è'}
  };
  function applyFooterI18n(root){
    var lang = uiLang();
    (root || document).querySelectorAll('.site-footer [data-legal]').forEach(function(a){
      var k = a.getAttribute('data-legal');
      a.href = './'+k+'.'+lang+'.html';
      a.textContent = (LABELS[lang] && LABELS[lang][k]) || (LABELS.en[k] || k);
      a.setAttribute('hreflang', lang);
    });
  }
  function injectFooter(){
    fetch('./footer_snippet.html', {cache: 'no-store'})
      .then(function(r){ return r.text(); })
      .then(function(html){
        var ph = document.getElementById('footer-placeholder');
        if (!ph) {
          ph = document.createElement('div');
          ph.id = 'footer-placeholder';
          document.body.appendChild(ph);
        }
        ph.innerHTML = html;
        applyFooterI18n(ph);
      })
      .catch(function(e){ console.error('Footer load failed:', e); });
  }
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', injectFooter);
  } else {
    injectFooter();
  }
  window.addEventListener('lexi:lang-changed', function(){ applyFooterI18n(); });
})();
</script>

<div id="footer-placeholder"></div>

<!-- Simple UI language API -->
<script>
(function(){
  function normalizeLang(v){
    v = String(v||'').toLowerCase();
    if (v.startsWith('ru')) return 'ru';
    if (v.startsWith('uk') || v.startsWith('ua')) return 'uk';
    return 'en';
  }

  // storage sync across tabs
  window.addEventListener('storage', function(ev){
    if (ev.key === 'lexitron.uiLang' && ev.newValue){
      try {
        var lang = normalizeLang(ev.newValue);
        if (window.App && App.settings) {
          try { App.settings.lang = lang; } catch (_) {}
        }
        window.dispatchEvent(new CustomEvent('lexi:lang-changed', {detail:{lang: lang}}));
      } catch(e){ console.error(e); }
    }
  });

  // Expose simple API
  window.setUiLang = function(lang){
    try {
      lang = normalizeLang(lang);
      try { localStorage.setItem('lexitron.uiLang', lang); } catch(_){}
      if (window.App && App.settings) {
        try { App.settings.lang = lang; } catch(_){}
      }
      window.dispatchEvent(new CustomEvent('lexi:lang-changed', {detail:{lang: lang}}));
    } catch(e){ console.error(e); }
  };

  // Patch App.settings.lang if needed
  try {
    if (window.App && App.settings && !Object.getOwnPropertyDescriptor(App.settings,'lang').set) {
      var _lang = (App.settings.lang || localStorage.getItem('lexitron.uiLang') || navigator.language || 'en');
      _lang = normalizeLang(_lang);
      Object.defineProperty(App.settings, 'lang', {
        get: function(){ return _lang; },
        set: function(v){
          _lang = normalizeLang(v);
          try { localStorage.setItem('lexitron.uiLang', _lang); } catch(_){}
          window.dispatchEvent(new CustomEvent('lexi:lang-changed', {detail:{lang: _lang}}));
        }
      });
    }
  } catch(e){ /* ignore */ }
})();
</script>

<!-- GA4 SPA & donate tracking -->
<script>
(function(){
  if (typeof window.trackPageView === 'function') {
    window.trackPageView(location.pathname + location.hash);
  }
  window.addEventListener('hashchange', function(){ window.trackPageView(location.pathname + location.hash); }, {passive:true});
  window.addEventListener('popstate', function(){ window.trackPageView(location.pathname + location.hash); }, {passive:true});
  document.addEventListener('i18n:lang-changed', function(){ window.trackPageView(location.pathname + '#lang'); }, false);
  window.addEventListener('lexi:lang-changed', function(){ window.trackPageView(location.pathname + '#lang'); }, false);

  function trackDonateOpen(){ try { gtag('event','donation_modal_open'); } catch(e){} }
  ['#donateBtn','#donateButton','[data-action="donate"]','.toolbar .coin','button.donate'].forEach(function(sel){
    var el = document.querySelector(sel); if (el) el.addEventListener('click', trackDonateOpen, {passive:true});
  });

  var dm = document.querySelector('#donateModal');
  if (dm) {
    var obs = new MutationObserver(function(muts){
      muts.forEach(function(m){
        if (m.type === 'attributes' && m.attributeName === 'class') {
          if (!dm.classList.contains('hidden')) trackDonateOpen();
        }
      });
    });
    obs.observe(dm, { attributes:true, attributeFilter:['class'] });
  }

  function onClick(sel, eventName){
    var el = document.querySelector(sel);
    if (el) el.addEventListener('click', function(){ try{ gtag('event', eventName); }catch(e){} }, {passive:true});
  }
  onClick('#monobankDonateLink','donation_monobank_click');
  onClick('a[href*="send.monobank.ua"]','donation_monobank_click');
  onClick('#paypalDonateLink','donation_paypal_click');
  onClick('a[href*="paypal.com"]','donation_paypal_click');
})();
</script>

<!-- PWA Service Worker -->
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
      navigator.serviceWorker.register('./sw.js?v=1.0').catch(function(e){ console.warn('SW registration failed', e); });
    });
  }
</script>

<script src="app.spoiler.bootstrap.js?v=1.0"></script>

</body>
</html>
<!-- ====================== End of file =======================
  File: index.html ‚Ä¢ Version: 1.0 ‚Ä¢ 2025-10-19
-->
